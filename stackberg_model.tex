% !TEX TS-program = pdflatex
% !TEX encoding = UTF-8 Unicode

% This is a simple template for a LaTeX document using the "article" class.
% See "book", "report", "letter" for other types of document.

\documentclass[11pt]{article} % use larger type; default would be 10pt

\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)

%%% Examples of Article customizations
% These packages are optional, depending whether you want the features they provide.
% See the LaTeX Companion or other references for full information.

%%% PAGE DIMENSIONS
\usepackage{geometry} % to change the page dimensions
\geometry{a4paper} % or letterpaper (US) or a5paper or....
% \geometry{margin=2in} % for example, change the margins to 2 inches all round
% \geometry{landscape} % set up the page for landscape
%   read geometry.pdf for detailed page layout information

\usepackage{graphicx} % support the \includegraphics command and options

% \usepackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather than an indent

%%% PACKAGES
\usepackage{booktabs} % for much better looking tables
\usepackage{array} % for better arrays (eg matrices) in maths
\usepackage{paralist} % very flexible & customisable lists (eg. enumerate/itemize, etc.)
\usepackage{verbatim} % adds environment for commenting out blocks of text & for better verbatim
\usepackage{subfig} % make it possible to include more than one captioned figure/table in a single float
% These packages are all incorporated in the memoir class to one degree or another...

%%% HEADERS & FOOTERS
\usepackage{fancyhdr} % This should be set AFTER setting up the page geometry
\pagestyle{fancy} % options: empty , plain , fancy
\renewcommand{\headrulewidth}{0pt} % customise the layout...
\lhead{}\chead{}\rhead{}
\lfoot{}\cfoot{\thepage}\rfoot{}

%%% SECTION TITLE APPEARANCE
\usepackage{sectsty}
\allsectionsfont{\sffamily\mdseries\upshape} % (See the fntguide.pdf for font help)
% (This matches ConTeXt defaults)

%%% ToC (table of contents) APPEARANCE
\usepackage[nottoc,notlof,notlot]{tocbibind} % Put the bibliography in the ToC
\usepackage[titles,subfigure]{tocloft} % Alter the style of the Table of Contents
\renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
\renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!



\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[english]{babel}
%%% END Article customizations

%%% The "real" document content comes below...
\addtocounter{MaxMatrixCols}{20}
\title{Stackberg Model}
\author{Qiu Jiayu}
%\date{} % Activate to display a given date or no date (if empty),
         % otherwise the current date is printed 

\begin{document}
\maketitle

\section{model}
\subsection{Original Model}

\begin{align}  
    &min \quad  x_i^T Q_i x_i + c_i^T x_i \nonumber\\
    &s.t. \quad A_ix_i \leq d_i
\end{align}






\subsection{Lagrange Model}
\begin{align}  
    L =  x_i^T Q_i x_i + c_i^T x_i + u_i^T( A_ix_i - d_i)
\end{align}


\begin{align} 
    KKT\begin{cases} 
            \frac{\partial L}{\partial x_i} = 2 Q_i x_i + c_i^T + A_i^T u_i = 0 \\
            -u_i \leq 0 \\
            u_i - M_iI_i \leq 0\\
            A_ix_i  \leq d_i \\
            - A_ix_i + I_i M_i \leq -d_i + E_i M_i
    \end{cases}
\end{align} 








the original problem is translated into the following problem
\begin{align}  
    &min \quad 1^T y_i \nonumber\\
    &s.t. \quad B_i y_i \leq r_i
\end{align}
\begin{align}  
    \begin{bmatrix}
         2 Q_i & A_i^T & 0\\
         -2 Q_i & -A_i^T & 0\\
         A_i & 0 & 0\\
         -A_i & 0 & diag(M_i)\\
         0 & diag(E_i) & diag(-M_i)\\
         0 & diag(-E_i) & 0\\
    \end{bmatrix}
    \begin{bmatrix}
        x_i \\
        u_i \\
        I_i 
    \end{bmatrix} \leq
    \begin{bmatrix}
        -c_{i}\\
        c_{i}\\
        d_i\\
        -d_i + M_i\\
        0\\
        0\\
    \end{bmatrix} 
\end{align}




\subsection{The Leader Model}
\begin{align}  
    &min \quad f(w)\nonumber\\
    &s.t. \quad Rw \geq r
\end{align}
\begin{align}  
    w = \{z, y_{1}, \cdots y_{N}\}
\end{align}


\begin{align}  
    \begin{bmatrix}
        -U_{1} & B_{1} & \cdots & \cdots & \cdots\\
        -U_{2} &\vdots  & B_{2} & \cdots & \cdots\\
         \vdots  & \vdots  & \vdots & \ddots  & \cdots\\
        -U_{N} & \cdots  & \cdots & \cdots & B_{N}\\
    \end{bmatrix}
    \begin{bmatrix}
        z\\
        y_1\\
        y_2\\
        \vdots \\
        y_N\\
    \end{bmatrix} \leq
    \begin{bmatrix}
        r_{1}^0\\
        r_{2}^0\\
        \vdots \\
        r_{n}^0\\
    \end{bmatrix}
\end{align}


\begin{align}  
    r = \begin{bmatrix}
        r_{1}^0\\
        r_{2}^0\\
        \vdots \\
        r_{n}^0\\
    \end{bmatrix}
\end{align}











































\subsection{Example}
the model for conventional ship  is
\begin{align}  
    &min \quad \frac{1}{2}bE_{si}^2 -aE_{si} + C_{si}P_{si}  \nonumber\\
    &s.t \begin{cases}
        E_{si} - E_{si}^{max} \leq 0\\
         -E_{si} + E_{si}^{min}\leq 0\\
         -P_{si}\leq 0\\
          P_{si} - P_{si}^{max} \leq 0
        \end{cases}
\end{align}
the model can be written in the form of matrix
\begin{align} 
    min \quad
    \begin{bmatrix}
        E_{ei}
        E_{si}
        P_{ei}
        P_{si}
    \end{bmatrix} 
    \begin{bmatrix}
        0 & 0 & 0 & 0\\
        0 & \frac{b}{2}  & 0 & 0\\
        0 & 0 & 0 & 0\\
        0 & 0 & 0 & 0
    \end{bmatrix} 
    \begin{bmatrix}
        E_{ei}\\
        E_{si}\\
        P_{ei}\\
        P_{si}
    \end{bmatrix} +
    \begin{bmatrix}
        0 & -a & 0 & C_{si}\\
    \end{bmatrix} 
    \begin{bmatrix}
        E_{ei}\\
        E_{si}\\
        P_{ei}\\
        P_{si}
    \end{bmatrix}
\end{align}

\begin{align} 
    \begin{bmatrix}
        0 & 1 & 0 & 0\\
        0 & -1 & 0 & 0\\
        0 & 0 & 0 & -1\\
        0 & 0 & 0 & 1
    \end{bmatrix} 
    \begin{bmatrix}
        E_{ei}\\
        E_{si}\\
        P_{ei}\\
        P_{si}
    \end{bmatrix} \leq
    \begin{bmatrix}
        E_{si}^{max}\\
        E_{si}^{min}\\
        0\\
        P_{s}^{max}
    \end{bmatrix}
\end{align}
the AES model:
\begin{align}  
    &min \quad \frac{1}{2}dE_{ei}^2 -cE_{ei} + C_{si}P_{si} +  C_{ei}P_{ei}\nonumber\\
    &s.t \begin{cases}
        E_{ei} - E_{ei}^{max} \leq 0\\
         -E_{ei} + E_{ei}^{min}\leq 0\\
         -P_{ei}\leq 0\\
          P_{ei} - P_{ei}^{max} \leq 0\\
          -P_{si}\leq 0\\
          P_{si} - P_{si}^{max} \leq 0
        \end{cases}
\end{align}
the model can be written in the form of matrix
\begin{align} 
    min \quad
    \begin{bmatrix}
        E_{ei}
        E_{si}
        P_{ei}
        P_{si}
    \end{bmatrix} 
    \begin{bmatrix}
        \frac{d}{2} & 0 & 0 & 0\\
        0 & 0  & 0 & 0\\
        0 & 0 & 0 & 0\\
        0 & 0 & 0 & 0
    \end{bmatrix} 
    \begin{bmatrix}
        E_{ei}\\
        E_{si}\\
        P_{ei}\\
        P_{si}
    \end{bmatrix} +
    \begin{bmatrix}
        -c & 0 & C_{ei} & C_{si}\\
    \end{bmatrix} 
    \begin{bmatrix}
        E_{ei}\\
        E_{si}\\
        P_{ei}\\
        P_{si}
    \end{bmatrix}
\end{align}

\begin{align} 
    \begin{bmatrix}
        1 & 0 & 0 & 0\\
        -1 & 0 & 0 & 0\\
        0 & 0 & -1 & 0\\
        0 & 0 & 1 & 0\\
        0 & 0 & 0 & -1\\
        0 & 0 & 0 & 1
    \end{bmatrix} 
    \begin{bmatrix}
        E_{ei}\\
        E_{si}\\
        P_{ei}\\
        P_{si}
    \end{bmatrix} \leq
    \begin{bmatrix}
        E_{ei}^{max}\\
        E_{ei}^{min}\\
        0\\
        P_{e}^{max}\\
        0\\
        P_{s}^{max}
    \end{bmatrix}
\end{align}
the leader model:
\begin{align}  
    &min \quad \sum_{t = 1}^{T} \Bigg[ \sum_{i \in \Omega_C\bigcup \Omega_A } (\lambda _{si} - C_{si}) P_{si} + 
    \sum_{i \in \Omega_A } (\lambda _{ei} - C_{ei}) P_{ei} \Bigg] \nonumber\\
    &s.t. \quad Mw \geq r
\end{align}
\begin{align}  
    w = \{z, y_{1}, \cdots y_{N}\}
\end{align}

\begin{align}  
    z_t = \begin{bmatrix}
        C_{et}\\
        C_{st}\\
    \end{bmatrix}
\end{align}
the model of conventional ship has 4 constrains,so the number of u and I vector is 4:
\begin{align}  
    y^{conventional}_t = \begin{bmatrix}
        E_{e}\\
        E_{s}\\
        P_{e}\\
        P_{s}\\
        u1\\
        u2\\
        u3\\
        u4\\
        I1\\
        I2\\
        I3\\
        I4\\
    \end{bmatrix}
\end{align}
the model of AES has 6 constrains,so the number of u and I vector is 6:
\begin{align}  
    y^{AES}_t = \begin{bmatrix}
        E_{e}\\
        E_{s}\\
        P_{e}\\
        P_{s}\\
        u1\\
        u2\\
        u3\\
        u4\\
        u5\\
        u6\\
        I1\\
        I2\\
        I3\\
        I4\\
        I5\\
        I6\\
    \end{bmatrix}
\end{align}




































\end{document}



